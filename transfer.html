
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Transfer in Progress</title>
  <style>
    body { font-family: sans-serif; padding: 40px; text-align: center; background: #f9f9f9; }
    #log { text-align: left; max-width: 800px; margin: 20px auto; white-space: pre-wrap; background: #fff; padding: 20px; border-radius: 10px; border: 1px solid #ccc; }
    button { padding: 10px 20px; font-size: 16px; background: #1db954; color: white; border: none; border-radius: 5px; cursor: pointer; }
  </style>
</head>
<body>
  <h2>Ready to Transfer üé∂</h2>
  <p>Click the button below to begin transferring playlists, liked songs, albums, and podcasts from source to target account.</p>
  <button onclick="start()">Start Transfer</button>
  <div id="log"></div>

  <script type="module">
    import { startTransfer, injectTokens } from './k2h-converter.js';

    function log(msg) {
      const logBox = document.getElementById('log');
      logBox.textContent += msg + '\n';
    }

    window.start = async function () {
      const source = localStorage.getItem('sourceToken');
      const target = localStorage.getItem('targetToken');
      if (!source || !target) {
        log("‚ùå Missing tokens. Please authenticate both accounts.");
        return;
      }
      injectTokens(source, target, log); // inject before running
      try {
        await startTransfer();
        log("‚úÖ Transfer complete!");
      } catch (err) {
        log("‚ùå Error: " + err.message);
      }
    }
  </script>
</body>
</html>
